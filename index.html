<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>expedition2grad | made with cables</title>
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1">
    <link href="https://fonts.googleapis.com/css?family=Archivo&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">

      </head>
      <body>

        <div class="application-wrapper">

          <div class="loading-screen">
            <div class="lds-roller"><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>
          </div>

          <div class="canvas-wrapper">
            <canvas id="glcanvas"></canvas>
          </div>

          <div class="side-panel">
            <div class="side-panel-inner">
              <input class="slider" type="range" min="0" max="100" value="0" oninput="getSliderValue()"></input>
            </div>
          </div>

          <div class="info-year">
            <h3 class="info-label">Jahr</h3>
            <h1 class="display">1880</h1>
          </div>

          <div class="info-temp">
            <h3 class="info-label"></h3>
            <h2 class="year">+0℃</h1>
          </div>

        </div>





    <libs/>
    <script type="text/javascript" src="js/patch.js"></script>


    <script>
        /**
         * Called when there was a cables error.
         * @param {string} errId - ID of the error, e.g. 'NO_WEBGL' or 'NO_WEBAUDIO'
         *                         when the browser does not support the used APIs
         * @param {string} errMsg - The error message
         */
        function showError(errId, errMsg) {
            alert('An error occured: ' + errId + ', ' + errMsg);
        }

        function patchInitialized() {
            // You can now access the patch object (CABLES.patch), register variable watchers and so on
        }

        function patchFinishedLoading() {
          document.querySelector('.application-wrapper').classList.add('loaded')
        }

        document.addEventListener('DOMContentLoaded', function(event) {
            CABLES.patch = new CABLES.Patch({
                patch: CABLES.exportedPatch,
                prefixAssetPath: '',
                glCanvasId: 'glcanvas',
                canvas:{
                    alpha:true,
                    premultipliedAlpha:true
                },
                glCanvasResizeToWindow: false,
                glCanvasResizeToParent: true,
                onError: showError,
                onPatchLoaded: patchInitialized,
                onFinishedLoading: patchFinishedLoading,
            });
        });

        function getSliderValue() {
           val = document.querySelector(".slider").value //gets the oninput value
           document.querySelector('.display').innerHTML = Math.round((1880 + 220 * (val/100)));
           document.querySelector('.display2').innerHTML = "+" + Math.round(( 2 * (val)))/100 + "℃";
           var valForCables = val/100;
           console.log(valForCables);
           CABLES.patch.setVariable("sliderInput", valForCables);
        }


    </script>
</body>
</html>
